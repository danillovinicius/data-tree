angular.module("ngDraggable",[]).directive("ngDrag",["$rootScope","$parse",function(e,t){return{restrict:"A",link:function(n,r,i){n.value=i.ngDrag;var s,o,u,a,f;var l="ontouchstart"in document.documentElement;var c="touchstart mousedown";var h="touchmove mousemove";var p="touchend mouseup";var d=$(document);var v=$(window);var m=null;var g=false;var y=null;var b=t(i.ngDragSuccess)||null;var w=function(){r.attr("draggable","false");E(true)};var E=function(e){if(!e)return;n.$on("$destroy",S);i.$observe("ngDrag",T);n.$watch(i.ngDragData,x);r.on(c,N);if(!l){r.on("mousedown",function(){return false})}};var S=function(e){E(false)};var x=function(e,t){m=e};var T=function(e,t){g=n.$eval(e)};var N=function(e){if(!g)return;if(l){C();y=setTimeout(function(){C();k(e)},100);d.on(h,C);d.on(p,C)}else{k(e)}};var C=function(){clearTimeout(y);d.off(h,C);d.off(p,C)};var k=function(t){if(!g)return;t.preventDefault();s=r.offset();r.centerX=r.width()/2;r.centerY=r.height()/2;r.addClass("dragging");o=t.pageX||t.originalEvent.touches[0].pageX;u=t.pageY||t.originalEvent.touches[0].pageY;a=o-r.centerX-v.scrollLeft();f=u-r.centerY-v.scrollTop();_(a,f);d.on(h,L);d.on(p,A);e.$broadcast("draggable:start",{x:o,y:u,tx:a,ty:f,element:r,data:m})};var L=function(t){if(!g)return;t.preventDefault();o=t.pageX||t.originalEvent.touches[0].pageX;u=t.pageY||t.originalEvent.touches[0].pageY;a=o-r.centerX-v.scrollLeft();f=u-r.centerY-v.scrollTop();_(a,f);e.$broadcast("draggable:move",{x:o,y:u,tx:a,ty:f,element:r,data:m})};var A=function(t){if(!g)return;t.preventDefault();e.$broadcast("draggable:end",{x:o,y:u,tx:a,ty:f,element:r,data:m,callback:O});r.removeClass("dragging");M();d.off(h,L);d.off(p,A)};var O=function(e){if(!b)return;n.$apply(function(){b(n,{$data:m,$event:e})})};var M=function(){r.css({left:"",top:"",position:"","z-index":""})};var _=function(e,t){r.css({left:e,top:t,position:"fixed","z-index":99999})};w()}}}]).directive("ngDrop",["$parse","$timeout",function(e,t){return{restrict:"A",link:function(n,r,i){n.value=i.ngDrop;var s=false;var o=e(i.ngDropSuccess);var u=function(){a(true)};var a=function(e){if(!e)return;i.$observe("ngDrop",l);n.$on("$destroy",f);n.$on("draggable:start",c);n.$on("draggable:move",h);n.$on("draggable:end",p)};var f=function(e){a(false)};var l=function(e,t){s=n.$eval(e)};var c=function(e,t){if(!s)return;d(t.x,t.y,t.element)};var h=function(e,t){if(!s)return;d(t.x,t.y,t.element)};var p=function(e,r){if(!s)return;if(d(r.x,r.y,r.element)){if(r.callback){r.callback(e)}t(function(){o(n,{$data:r.data,$event:e})})}v(false,r.element)};var d=function(e,t,n){var r=m(e,t);v(r,n);return r};var v=function(e,t){if(e){r.addClass("drag-enter");t.addClass("drag-over")}else{r.removeClass("drag-enter");t.removeClass("drag-over")}};var m=function(e,t){var n=r.offset();n.right=n.left+r.outerWidth();n.bottom=n.top+r.outerHeight();return e>=n.left&&e<=n.right&&t<=n.bottom&&t>=n.top};u()}}}]).directive("ngDragClone",["$parse","$timeout",function(e,t){return{restrict:"A",link:function(e,t,n){var r;e.clonedData={};var i=function(){r=$(t.find("img"));t.attr("draggable","false");r.attr("draggable","false");l();s(true)};var s=function(t){if(!t)return;e.$on("draggable:start",u);e.$on("draggable:move",a);e.$on("draggable:end",f);o()};var o=function(){r.off("mousedown touchstart touchmove touchend touchcancel",h);r.on("mousedown touchstart touchmove touchend touchcancel",h)};var u=function(n,r){e.$apply(function(){e.clonedData=r.data});t.css("width",r.element.height());t.css("height",r.element.height());c(r.tx,r.ty)};var a=function(e,t){c(t.tx,t.ty)};var f=function(e,t){l()};var l=function(){t.css({left:0,top:0,position:"fixed","z-index":-1,visibility:"hidden"})};var c=function(e,n){t.css({left:e,top:n,position:"fixed","z-index":99999,visibility:"visible"})};var h=function(e){var t=e.originalEvent;t.preventDefault&&t.preventDefault();t.stopPropagation&&t.stopPropagation();t.cancelBubble=true;t.returnValue=false;return false};i()}}}]).directive("ngPreventDrag",["$parse","$timeout",function(e,t){return{restrict:"A",link:function(e,t,n){var r=function(){t.attr("draggable","false");i(true)};var i=function(e){if(!e)return;t.on("mousedown touchstart touchmove touchend touchcancel",s)};var s=function(e){var t=e.originalEvent;t.preventDefault&&t.preventDefault();t.stopPropagation&&t.stopPropagation();t.cancelBubble=true;t.returnValue=false;return false};r()}}}])